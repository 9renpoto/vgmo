---
import { Breadcrumbs } from "@vgmo/ui/src/Breadcrumbs";
import Card from "@vgmo/ui/src/Card";
import type { CardProps } from "@vgmo/ui/src/Card";
import type { ConcertWithMeta } from "../utils/concerts";
import { listConcerts } from "../utils/concerts";
import MainLayout from "../layouts/MainLayout.astro";

const toCard = (c: ConcertWithMeta): CardProps => ({
  title: c.title,
  imageUrl: c.image,
  date: new Date(c.date).toLocaleDateString("ja-JP"),
  time: c.startTime,
  location: c.venue,
  description: c.memo || `開場: ${c.openingTime || "N/A"}`,
  tags: c.bands || [],
  buttonText: "チケットサイトへ",
  buttonUrl: c.ticketUrl,
  sourceName: new URL(c.sourceUrl).hostname,
  sourceUrl: c.sourceUrl,
});

const concerts = await listConcerts();
---

<MainLayout title="vgmo | ゲーム音楽オーケストラまとめ">
  <div class="space-y-4">
    <Breadcrumbs
      breadcrumbs={[
        { label: "Home", href: "#" },
        { label: "演奏情報" },
      ]}
    />
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
      {concerts.map((c) => <Card {...toCard(c)} />)}
    </div>
  </div>
</MainLayout>
